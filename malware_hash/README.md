# Malware Hash

Malware sometimes use hashes functions, applied on input strings such as running process names, loaded DLLs or usernames, in order to detect whether they are running under a debugged, virtualized or sandboxed environement. They may also use the same method in order to identify legitimate windows executable or web-browsers to perform process hollowing or code injection.

The goal of this repository is to provide a small python script used to request JSON files containing strings likely to be used by malware.

A first JSON file (hash_sources.json) provides strings such as:

 * VMs related image name such as 'vmware.exe'
 * Malware analysis tools such as debuggers, static analysis tools, ...
 * Common tools running in sandboxes such as 'python.exe'
 * HIPS / Anti-viruses injected DLLs image name
 * Well known sandbox usernames
 * SysInternals tools image name
 * Win32 PE image name (DLLs and executables)

A second JSON file (files_net.json) provides a dump of all filenames referenced on https://www.file.net/ (~ 19k entries).

## API Usage

The API is really simple to use. The constructor of the class *MalwareHash* takes as a first argument the user-defined hash function, used to build a dictionary with:
 * keys beeing the computed hashes values of each input string contained within JSON source files
 * values beeing the list of strings matching a computed hash value

An instance of the class *MalwareHash* can be used to get the list of strings matching a pre-computed hash value, by calling the *get_strings_by_hash()* method.

## Example

```python
from malware_hash import MalwareHash
import binascii

mh = MalwareHash(binascii.crc32)
string_list = mh.get_strings_by_hash(0x77ae10f7)
print(string_list) # ['u'wireshark.exe]
```
